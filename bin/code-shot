#!/usr/bin/env bash

THEME="gruvbox"
OUTPUT_DIR="$HOME/Screenshots"
TIME_HHMMSS=$(date +%H-%M-%S)
DATE_DDMMM=$(date +%d-%b)

mkdir -p "$OUTPUT_DIR"

FILE_PATH="$1"

if [[ -z "$FILE_PATH" ]]; then
  echo "Usage: $0 /path/to/file"
  exit 1
fi

if [[ ! -f "$FILE_PATH" ]]; then
  echo "Error: File not found: $FILE_PATH"
  exit 1
fi

OUTPUT_FILE="$(basename "$FILE_PATH") ($TIME_HHMMSS) ($DATE_DDMMM).png"
OUTPUT_PATH="$OUTPUT_DIR/$OUTPUT_FILE"

freeze \
  -t "$THEME" \
  "$FILE_PATH" \
  --padding 20 \
  --font.family "JetBrains Mono Nerd Font" \
  --font.size 16 \
  --line-height 1.4 \
  --show-line-numbers \
  --window \
  --output "$OUTPUT_PATH"

echo "Screenshot saved to $OUTPUT_PATH"

if command -v notify-send >/dev/null 2>&1; then
  notify-send -i "$OUTPUT_PATH" "Screenshot Created" "Saved to: $OUTPUT_PATH"
fi
